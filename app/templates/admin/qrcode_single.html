{% extends "base.html" %}

{% block title %}{{ patient.name }} çš„ QR Code - é«˜æª¢ç—…äººå‹•æ…‹ç³»çµ±{% endblock %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">ğŸ“± ç—…äºº QR Code</h1>
    <a href="/admin/qrcode" class="text-blue-500 hover:underline">â† è¿”å›åˆ—è¡¨</a>
</div>

<div class="max-w-md mx-auto">
    <!-- QR Code å¡ç‰‡ -->
    <div class="bg-white rounded-2xl shadow-lg p-8 text-center">
        <!-- QR Code åœ–ç‰‡ -->
        <div class="mb-6">
            <img src="data:image/png;base64,{{ qrcode.qrcode_base64 }}" 
                 alt="QR Code"
                 class="w-64 h-64 mx-auto">
        </div>
        
        <!-- ç—…äººè³‡è¨Š -->
        <h2 class="text-2xl font-bold text-gray-800 mb-2">{{ patient.name }}</h2>
        <p class="text-gray-500 mb-4">ç—…æ­·è™Ÿï¼š{{ patient.chart_no }}</p>
        
        {% if patient.exam_list %}
        <div class="bg-gray-50 rounded-lg p-3 mb-4">
            <p class="text-sm text-gray-500">æª¢æŸ¥é …ç›®</p>
            <p class="font-medium">{{ patient.exam_list }}</p>
        </div>
        {% endif %}
        
        <div class="text-sm text-blue-600 mb-6">
            æª¢æŸ¥æ—¥æœŸï¼š{{ patient.exam_date }}
        </div>
        
        <!-- æ“ä½œæŒ‰éˆ• -->
        <div class="flex gap-4 justify-center">
            <a href="/admin/qrcode/patient/{{ patient.id }}/image"
               download="qrcode_{{ patient.chart_no }}.png"
               class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg">
                â¬‡ï¸ ä¸‹è¼‰åœ–ç‰‡
            </a>
            <button onclick="window.print()"
                    class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg">
                ğŸ–¨ï¸ åˆ—å°
            </button>
        </div>
    </div>
    
    <!-- å ±åˆ°é€£çµ -->
    <div class="mt-6 bg-gray-50 rounded-xl p-4">
        <p class="text-sm text-gray-500 mb-2">å ±åˆ°é€£çµï¼š</p>
        <div class="bg-white rounded-lg p-3 break-all text-xs text-gray-600 font-mono">
            {{ qrcode.url }}
        </div>
    </div>
    
    <!-- èªªæ˜ -->
    <div class="mt-4 text-center text-sm text-gray-400">
        <p>æ­¤ QR Code åƒ…åœ¨ {{ patient.exam_date }} ç•¶å¤©æœ‰æ•ˆ</p>
    </div>
</div>

<style>
@media print {
    nav, .no-print, a[href="/admin/qrcode"] { display: none !important; }
    .shadow-lg { box-shadow: none !important; }
}
</style>
{% endblock %}
