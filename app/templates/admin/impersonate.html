{% extends "base.html" %}

{% block title %}è§’è‰²æ¨¡æ“¬ - é«˜æª¢ç—…äººå‹•æ…‹ç³»çµ±{% endblock %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">ğŸ­ è§’è‰²æ¨¡æ“¬</h1>
    <a href="/admin" class="text-blue-500 hover:underline">â† è¿”å›ç®¡ç†å¾Œå°</a>
</div>

<!-- èªªæ˜ -->
<div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6">
    <p class="text-blue-800">
        <span class="font-bold">ğŸ’¡ ä½¿ç”¨èªªæ˜ï¼š</span>
        é¸æ“‡è¦æ¨¡æ“¬çš„è§’è‰²å’Œç”¨æˆ¶ï¼Œå³å¯åˆ‡æ›åˆ°è©²ç”¨æˆ¶çš„è¦–è§’æŸ¥çœ‹ç³»çµ±ç•«é¢ã€‚
        æ¨¡æ“¬æœŸé–“æœƒåœ¨é ‚éƒ¨é¡¯ç¤ºç´…è‰²æç¤ºæ¢ã€‚
    </p>
</div>

{% if impersonate_status.is_impersonating %}
<!-- ç›®å‰æ­£åœ¨æ¨¡æ“¬ -->
<div class="bg-red-50 border border-red-200 rounded-xl p-6 mb-6">
    <div class="flex justify-between items-center">
        <div>
            <span class="text-2xl mr-2">ğŸ­</span>
            <span class="font-bold text-red-700">ç›®å‰æ­£åœ¨æ¨¡æ“¬ï¼š</span>
            <span class="text-red-600">{{ impersonate_status.role_name }}</span>
        </div>
        <form action="/admin/impersonate/end" method="POST">
            <button type="submit" 
                    class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-bold">
                ğŸ›‘ çµæŸæ¨¡æ“¬
            </button>
        </form>
    </div>
</div>
{% endif %}

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    
    <!-- æ¨¡æ“¬çµ„é•· -->
    <div class="bg-white rounded-xl shadow p-6">
        <h3 class="font-bold text-lg text-purple-700 mb-4">ğŸ‘‘ æ¨¡æ“¬çµ„é•·</h3>
        <p class="text-sm text-gray-500 mb-4">çµ„é•·åŒæ™‚æ“æœ‰èª¿åº¦å“¡å’Œå°ˆå“¡æ¬Šé™</p>
        
        {% if leaders %}
        <form action="/admin/impersonate/start" method="POST">
            <input type="hidden" name="role" value="leader">
            <div class="space-y-3">
                <select name="user_id" required class="w-full border rounded-lg px-3 py-2">
                    <option value="">é¸æ“‡çµ„é•·</option>
                    {% for u in leaders %}
                    <option value="{{ u.id }}">{{ u.display_name }}</option>
                    {% endfor %}
                </select>
                <button type="submit" 
                        class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg font-medium">
                    ğŸ­ é–‹å§‹æ¨¡æ“¬
                </button>
            </div>
        </form>
        {% else %}
        <p class="text-gray-400 text-center py-4">ç›®å‰æ²’æœ‰çµ„é•·</p>
        {% endif %}
    </div>
    
    <!-- æ¨¡æ“¬èª¿åº¦å“¡ -->
    <div class="bg-white rounded-xl shadow p-6">
        <h3 class="font-bold text-lg text-blue-700 mb-4">ğŸ“Š æ¨¡æ“¬èª¿åº¦å“¡</h3>
        <p class="text-sm text-gray-500 mb-4">æŸ¥çœ‹èª¿åº¦å“¡çš„ç—…äººæŒ‡æ´¾èˆ‡ç›£æ§ç•«é¢</p>
        
        {% if dispatchers %}
        <form action="/admin/impersonate/start" method="POST">
            <input type="hidden" name="role" value="dispatcher">
            <div class="space-y-3">
                <select name="user_id" required class="w-full border rounded-lg px-3 py-2">
                    <option value="">é¸æ“‡èª¿åº¦å“¡</option>
                    {% for u in dispatchers %}
                    <option value="{{ u.id }}">{{ u.display_name }}</option>
                    {% endfor %}
                </select>
                <button type="submit" 
                        class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg font-medium">
                    ğŸ­ é–‹å§‹æ¨¡æ“¬
                </button>
            </div>
        </form>
        {% else %}
        <p class="text-gray-400 text-center py-4">ç›®å‰æ²’æœ‰èª¿åº¦å“¡</p>
        {% endif %}
    </div>
    
    <!-- æ¨¡æ“¬å°ˆå“¡ -->
    <div class="bg-white rounded-xl shadow p-6">
        <h3 class="font-bold text-lg text-green-700 mb-4">ğŸ‘¤ æ¨¡æ“¬å°ˆå“¡</h3>
        <p class="text-sm text-gray-500 mb-4">æŸ¥çœ‹å°ˆå“¡çš„ç—…äººé™ªåŒèˆ‡ç‹€æ…‹å›å ±ç•«é¢</p>
        
        {% if coordinators %}
        <form action="/admin/impersonate/start" method="POST">
            <input type="hidden" name="role" value="coordinator">
            <div class="space-y-3">
                <select name="user_id" required class="w-full border rounded-lg px-3 py-2">
                    <option value="">é¸æ“‡å°ˆå“¡</option>
                    {% for u in coordinators %}
                    <option value="{{ u.id }}">{{ u.display_name }}</option>
                    {% endfor %}
                </select>
                <button type="submit" 
                        class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium">
                    ğŸ­ é–‹å§‹æ¨¡æ“¬
                </button>
            </div>
        </form>
        {% else %}
        <p class="text-gray-400 text-center py-4">ç›®å‰æ²’æœ‰å°ˆå“¡</p>
        {% endif %}
    </div>
    
</div>

<!-- æ¨¡æ“¬ç—…äººï¼ˆæœªä¾†åŠŸèƒ½ï¼‰
<div class="mt-6 bg-gray-100 rounded-xl p-6">
    <h3 class="font-bold text-lg text-gray-500 mb-2">ğŸ¥ æ¨¡æ“¬ç—…äººè¦–è§’</h3>
    <p class="text-sm text-gray-400">æ­¤åŠŸèƒ½é–‹ç™¼ä¸­ï¼Œæ•¬è«‹æœŸå¾…...</p>
</div>
-->

{% endblock %}
