{% extends "base.html" %}

{% block title %}æª¢æŸ¥é …ç›®ç®¡ç† - é«˜æª¢ç—…äººå‹•æ…‹ç³»çµ±{% endblock %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">ğŸ”¬ æª¢æŸ¥é …ç›®ç®¡ç†</h1>
    <a href="/admin" class="text-blue-500 hover:underline">â† è¿”å›ç®¡ç†å¾Œå°</a>
</div>

<!-- æ–°å¢è¡¨å–® -->
<div class="bg-white rounded-xl shadow p-6 mb-6">
    <h2 class="text-lg font-bold text-gray-700 mb-4">æ–°å¢/ç·¨è¼¯æª¢æŸ¥é …ç›®</h2>
    <form action="/admin/exams/add" method="POST" class="flex flex-wrap gap-4 items-end">
        <div>
            <label class="block text-sm text-gray-600 mb-1">æª¢æŸ¥ä»£ç¢¼</label>
            <input type="text" name="exam_code" required
                   placeholder="å¦‚: CT"
                   class="border rounded-lg px-3 py-2 w-32">
        </div>
        <div>
            <label class="block text-sm text-gray-600 mb-1">æª¢æŸ¥åç¨±</label>
            <input type="text" name="name" required
                   placeholder="å¦‚: é›»è…¦æ–·å±¤"
                   class="border rounded-lg px-3 py-2 w-48">
        </div>
        <div>
            <label class="block text-sm text-gray-600 mb-1">é ä¼°æ™‚é–“(åˆ†)</label>
            <input type="number" name="duration_minutes" value="15"
                   class="border rounded-lg px-3 py-2 w-24">
        </div>
        <div>
            <label class="block text-sm text-gray-600 mb-1">ä½ç½®èªªæ˜</label>
            <input type="text" name="location"
                   placeholder="å¦‚: 1æ¨“å½±åƒä¸­å¿ƒ"
                   class="border rounded-lg px-3 py-2 w-40">
        </div>
        <button type="submit"
                class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium">
            â• æ–°å¢
        </button>
    </form>
</div>

<!-- åˆå§‹åŒ–æŒ‰éˆ• -->
<div class="mb-6">
    <form action="/admin/exams/init" method="POST" class="inline">
        <button type="submit"
                class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">
            ğŸš€ åˆå§‹åŒ–é è¨­æª¢æŸ¥é …ç›®
        </button>
    </form>
</div>

<!-- æª¢æŸ¥é …ç›®åˆ—è¡¨ -->
<div class="bg-white rounded-xl shadow overflow-hidden">
    <table class="w-full">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">ä»£ç¢¼</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">åç¨±</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ™‚é–“</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">ä½ç½®</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">ç‹€æ…‹</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ“ä½œ</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
            {% for exam in exams %}
            <tr class="hover:bg-gray-50 {% if not exam.is_active %}opacity-50{% endif %}">
                <td class="px-4 py-3 font-mono font-bold text-blue-600">{{ exam.exam_code }}</td>
                <td class="px-4 py-3">{{ exam.name }}</td>
                <td class="px-4 py-3">{{ exam.duration_minutes }} åˆ†</td>
                <td class="px-4 py-3 text-gray-500">{{ exam.location or '-' }}</td>
                <td class="px-4 py-3">
                    {% if exam.is_active %}
                    <span class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">å•Ÿç”¨</span>
                    {% else %}
                    <span class="px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs">åœç”¨</span>
                    {% endif %}
                </td>
                <td class="px-4 py-3">
                    {% if exam.is_active %}
                    <form action="/admin/exams/{{ exam.id }}/delete" method="POST" class="inline"
                          onsubmit="return confirm('ç¢ºå®šè¦åœç”¨æ­¤æª¢æŸ¥é …ç›®ï¼Ÿ')">
                        <button type="submit" class="text-red-500 hover:text-red-700 text-sm">
                            ğŸ—‘ï¸ åœç”¨
                        </button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            
            {% if not exams %}
            <tr>
                <td colspan="6" class="px-4 py-12 text-center text-gray-500">
                    <div class="text-4xl mb-4">ğŸ“­</div>
                    <p>å°šç„¡æª¢æŸ¥é …ç›®</p>
                    <p class="text-sm">é»æ“Šä¸Šæ–¹ã€Œåˆå§‹åŒ–é è¨­æª¢æŸ¥é …ç›®ã€å»ºç«‹</p>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
