{% extends "base.html" %}

{% block title %}管理後台 - 高檢病人動態系統{% endblock %}

{% block content %}
<div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-800">🛠️ 管理後台</h1>
    <p class="text-gray-500 mt-1">系統設定與資料管理</p>
</div>

<!-- 統計卡片 -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
    <div class="bg-white rounded-xl shadow p-5">
        <div class="flex items-center justify-between">
            <div>
                <div class="text-3xl font-bold text-blue-600">{{ user_count }}</div>
                <div class="text-gray-500 text-sm">使用者</div>
            </div>
            <div class="text-4xl">👥</div>
        </div>
        {% if pending_count > 0 %}
        <div class="mt-2 text-orange-500 text-sm">⏳ {{ pending_count }} 人待審核</div>
        {% endif %}
    </div>
    
    <div class="bg-white rounded-xl shadow p-5">
        <div class="flex items-center justify-between">
            <div>
                <div class="text-3xl font-bold text-green-600">{{ patient_count }}</div>
                <div class="text-gray-500 text-sm">今日病人</div>
            </div>
            <div class="text-4xl">🏥</div>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow p-5">
        <div class="flex items-center justify-between">
            <div>
                <div class="text-3xl font-bold text-purple-600">{{ exam_count }}</div>
                <div class="text-gray-500 text-sm">檢查項目</div>
            </div>
            <div class="text-4xl">🔬</div>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow p-5">
        <div class="flex items-center justify-between">
            <div>
                <div class="text-3xl font-bold {% if broken_count > 0 %}text-red-600{% else %}text-green-600{% endif %}">
                    {{ equipment_count }}
                </div>
                <div class="text-gray-500 text-sm">設備數</div>
            </div>
            <div class="text-4xl">🖥️</div>
        </div>
        {% if broken_count > 0 %}
        <div class="mt-2 text-red-500 text-sm">🔴 {{ broken_count }} 台故障</div>
        {% endif %}
    </div>
</div>

<!-- 功能區塊 -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- 系統設定 -->
    <a href="/admin/settings" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group border-2 border-yellow-100">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">⚙️</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">系統設定</h3>
                <p class="text-sm text-gray-500">新用戶預設角色等設定</p>
            </div>
        </div>
    </a>
    
    <!-- 帳號管理 -->
    <a href="/admin/users" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">👥</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">帳號管理</h3>
                <p class="text-sm text-gray-500">使用者審核與權限設定</p>
            </div>
        </div>
        {% if pending_count > 0 %}
        <div class="bg-orange-50 text-orange-700 px-3 py-2 rounded-lg text-sm">
            ⏳ {{ pending_count }} 個帳號待審核
        </div>
        {% endif %}
    </a>
    
    <!-- 病人管理 -->
    <a href="/admin/patients" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">📋</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">病人管理</h3>
                <p class="text-sm text-gray-500">病人資料與 CSV 匯入</p>
            </div>
        </div>
    </a>
    
    <!-- 檢查項目管理 -->
    <a href="/admin/exams" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">🔬</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">檢查項目管理</h3>
                <p class="text-sm text-gray-500">檢查站設定</p>
            </div>
        </div>
    </a>
    
    <!-- 設備管理 -->
    <a href="/admin/equipment" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">🖥️</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">設備管理</h3>
                <p class="text-sm text-gray-500">設備狀態與故障處理</p>
            </div>
        </div>
        {% if broken_count > 0 %}
        <div class="bg-red-50 text-red-700 px-3 py-2 rounded-lg text-sm">
            🔴 {{ broken_count }} 台設備故障
        </div>
        {% endif %}
    </a>
    
    <!-- 統計報表 -->
    <a href="/admin/reports" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">📊</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">統計報表</h3>
                <p class="text-sm text-gray-500">數據分析與匯出</p>
            </div>
        </div>
    </a>
    
    <!-- 角色模擬 -->
    <a href="/admin/impersonate" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group border-2 border-purple-100">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">🎭</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">角色模擬</h3>
                <p class="text-sm text-gray-500">切換視角查看其他角色畫面</p>
            </div>
        </div>
    </a>
    
    <!-- 調度台 -->
    <a href="/dispatcher" 
       class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition group border-2 border-blue-100">
        <div class="flex items-center mb-4">
            <div class="text-4xl mr-4 group-hover:scale-110 transition">📊</div>
            <div>
                <h3 class="font-bold text-lg text-gray-800">前往調度台</h3>
                <p class="text-sm text-gray-500">病人指派與即時監控</p>
            </div>
        </div>
    </a>
</div>

<!-- 快速初始化 -->
<div class="mt-8 bg-gray-50 rounded-xl p-6">
    <h3 class="font-bold text-gray-700 mb-4">🚀 快速初始化</h3>
    <div class="flex flex-wrap gap-4">
        <form action="/admin/exams/init" method="POST" class="inline">
            <button type="submit" 
                    class="px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg text-sm">
                🔬 初始化檢查項目
            </button>
        </form>
        <form action="/admin/equipment/init" method="POST" class="inline">
            <button type="submit" 
                    class="px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm">
                🖥️ 初始化設備
            </button>
        </form>
    </div>
</div>
{% endblock %}
