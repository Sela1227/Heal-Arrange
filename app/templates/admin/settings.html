{% extends "base.html" %}

{% block title %}系統設定 - 高檢病人動態系統{% endblock %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">⚙️ 系統設定</h1>
    <a href="/admin" class="text-blue-500 hover:underline">← 返回管理後台</a>
</div>

{% if saved %}
<div class="bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-xl mb-6">
    ✅ 設定已儲存
</div>
{% endif %}

<!-- 新用戶預設角色 -->
<div class="bg-white rounded-xl shadow p-6 mb-6">
    <h2 class="text-lg font-bold text-gray-700 mb-4">👤 新用戶預設角色</h2>
    <p class="text-sm text-gray-500 mb-4">
        設定新註冊用戶的預設角色。使用 LINE 登入的新用戶會自動被設為此角色。
    </p>
    
    <form action="/admin/settings/default-role" method="POST" class="space-y-4">
        <div class="flex flex-wrap gap-4">
            {% for role in roles %}
            <label class="flex items-center space-x-2 cursor-pointer">
                <input type="radio" name="default_role" value="{{ role.value }}"
                       {% if default_role == role.value %}checked{% endif %}
                       class="w-4 h-4 text-blue-600">
                <span class="{% if role.value == 'pending' %}text-yellow-600{% elif role.value == 'coordinator' %}text-green-600{% elif role.value == 'dispatcher' %}text-blue-600{% elif role.value == 'leader' %}text-purple-600{% endif %} font-medium">
                    {{ role.label }}
                </span>
            </label>
            {% endfor %}
        </div>
        
        <div class="bg-gray-50 rounded-lg p-4 text-sm">
            <p class="font-medium text-gray-700 mb-2">角色說明：</p>
            <ul class="space-y-1 text-gray-600">
                <li>⏳ <strong>待審核</strong> - 需要管理員審核後才能使用系統</li>
                <li>👤 <strong>專員</strong> - 可陪同病人、回報狀態</li>
                <li>📊 <strong>調度員</strong> - 可指派病人、即時監控</li>
                <li>👑 <strong>組長</strong> - 同時擁有調度員和專員權限</li>
            </ul>
        </div>
        
        <div class="pt-4">
            <button type="submit" 
                    class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium">
                💾 儲存設定
            </button>
        </div>
    </form>
</div>

<!-- 目前設定 -->
<div class="bg-white rounded-xl shadow p-6">
    <h2 class="text-lg font-bold text-gray-700 mb-4">📋 目前設定</h2>
    <table class="w-full text-sm">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-2 text-left">設定項目</th>
                <th class="px-4 py-2 text-left">目前值</th>
                <th class="px-4 py-2 text-left">說明</th>
            </tr>
        </thead>
        <tbody class="divide-y">
            {% for key, info in settings.items() %}
            <tr>
                <td class="px-4 py-3 font-mono text-xs">{{ key }}</td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">
                        {{ info.value }}
                    </span>
                    {% if info.is_default %}
                    <span class="text-gray-400 text-xs ml-1">(預設)</span>
                    {% endif %}
                </td>
                <td class="px-4 py-3 text-gray-500">{{ info.description }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- 提示 -->
<div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-xl p-4">
    <p class="text-yellow-800 text-sm">
        💡 <strong>提示：</strong>變更預設角色只會影響新註冊的用戶，不會改變現有用戶的角色。
        如需變更現有用戶角色，請至「帳號管理」頁面操作。
    </p>
</div>
{% endblock %}
