<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªåŠ©å ±åˆ° - é«˜æª¢ç—…äººå‹•æ…‹ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="bg-gradient-to-b from-blue-50 to-white min-h-screen">
    <div class="max-w-md mx-auto px-4 py-8">
        <!-- æ¨™é¡Œ -->
        <div class="text-center mb-8">
            <div class="text-6xl mb-4">ğŸ¥</div>
            <h1 class="text-2xl font-bold text-gray-800">å½°æ¿±ç§€å‚³é«˜ç´šå¥æª¢</h1>
            <p class="text-gray-500 mt-2">è‡ªåŠ©å ±åˆ°ç³»çµ±</p>
        </div>
        
        <!-- ç—…äººè³‡è¨Šå¡ç‰‡ -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex items-center mb-4">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center text-3xl mr-4">
                    ğŸ‘¤
                </div>
                <div>
                    <h2 class="text-xl font-bold text-gray-800">{{ patient.name }}</h2>
                    <p class="text-gray-500">ç—…æ­·è™Ÿï¼š{{ patient.chart_no }}</p>
                </div>
            </div>
            
            <div class="border-t pt-4">
                <div class="flex justify-between text-sm mb-2">
                    <span class="text-gray-500">æª¢æŸ¥æ—¥æœŸ</span>
                    <span class="font-medium">{{ patient.exam_date }}</span>
                </div>
                {% if patient.exam_list %}
                <div class="flex justify-between text-sm">
                    <span class="text-gray-500">æª¢æŸ¥é …ç›®</span>
                    <span class="font-medium">{{ patient.exam_list }}</span>
                </div>
                {% endif %}
            </div>
        </div>
        
        {% if already_checked_in %}
        <!-- å·²å ±åˆ°ç‹€æ…‹ -->
        <div class="bg-green-50 border border-green-200 rounded-2xl p-6 mb-6">
            <div class="text-center">
                <div class="text-5xl mb-4">âœ…</div>
                <h3 class="text-xl font-bold text-green-800 mb-2">æ‚¨å·²å®Œæˆå ±åˆ°</h3>
                <p class="text-green-600">
                    ç›®å‰ä½ç½®ï¼š{{ tracking.current_location if tracking else 'ç­‰å€™å€' }}
                </p>
            </div>
        </div>
        
        {% if wait_info %}
        <!-- ç­‰å€™è³‡è¨Š -->
        <div class="bg-white rounded-2xl shadow p-6 mb-6"
             hx-get="/checkin/{{ token }}/status"
             hx-trigger="every 30s"
             hx-swap="innerHTML">
            <div class="text-center">
                <p class="text-gray-500 mb-2">é ä¼°ç­‰å€™æ™‚é–“</p>
                <p class="text-4xl font-bold text-blue-600">
                    {% if wait_info.estimated_wait <= 0 %}
                    å³å°‡è¼ªåˆ°
                    {% elif wait_info.estimated_wait < 60 %}
                    ç´„ {{ wait_info.estimated_wait }} åˆ†é˜
                    {% else %}
                    ç´„ {{ wait_info.estimated_wait // 60 }} å°æ™‚
                    {% endif %}
                </p>
                <p class="text-sm text-gray-400 mt-2">
                    å‰é¢é‚„æœ‰ {{ wait_info.waiting_count }} äººç­‰å€™
                </p>
            </div>
        </div>
        {% endif %}
        
        {% else %}
        <!-- å ±åˆ°æŒ‰éˆ• -->
        <form action="/checkin/{{ token }}" method="POST">
            <button type="submit"
                    class="w-full bg-blue-500 hover:bg-blue-600 text-white text-xl font-bold py-4 px-6 rounded-2xl shadow-lg transition transform hover:scale-105">
                ğŸ“ ç¢ºèªå ±åˆ°
            </button>
        </form>
        
        <p class="text-center text-gray-400 text-sm mt-4">
            é»æ“ŠæŒ‰éˆ•å®Œæˆå ±åˆ°ï¼Œä¹‹å¾Œè«‹åœ¨ç­‰å€™å€ç­‰å€™å«è™Ÿ
        </p>
        {% endif %}
        
        <!-- æ³¨æ„äº‹é … -->
        <div class="bg-yellow-50 rounded-xl p-4 mt-8">
            <h4 class="font-bold text-yellow-800 mb-2">ğŸ“‹ æº«é¦¨æé†’</h4>
            <ul class="text-sm text-yellow-700 space-y-1">
                <li>â€¢ è«‹ä¿æŒæ‰‹æ©Ÿæš¢é€šï¼Œæˆ‘å€‘æœƒé€é LINE é€šçŸ¥æ‚¨</li>
                <li>â€¢ å¦‚éœ€å”åŠ©ï¼Œè«‹è‡³æœå‹™å°è©¢å•</li>
                <li>â€¢ æª¢æŸ¥éç¨‹ä¸­è«‹å‹¿é£²é£Ÿ</li>
            </ul>
        </div>
        
        <!-- åº•éƒ¨ -->
        <div class="text-center mt-8 text-gray-400 text-sm">
            <p>å½°æ¿±ç§€å‚³ç´€å¿µé†«é™¢</p>
            <p>é«˜ç´šå¥æª¢ä¸­å¿ƒ</p>
        </div>
    </div>
</body>
</html>
